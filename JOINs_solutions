-- ðŸ”¹ LEVEL 1 â€” Basic JOINs
-- Q1. INNER JOIN
-- Tables:
-- employees(emp_id, emp_name, dept_id)
-- departments(dept_id, dept_name)
-- Write a query to fetch employee name and department name.
SELECT e.emp_name AS employee_name, d.dept_name AS department_name FROM employees e JOIN departments d ON e.dept_id = d.dept_id;

-- Q2. LEFT JOIN
--Tables:
--employees(emp_id, emp_name, manager_id)
-- Write a query to fetch all employees and their manager names. (Manager is also in the same table).
SELECT e.emp_name AS employee_name, m.emp_name AS manager_name FROM employees e LEFT JOIN employees m ON e.emp_id = m.manager_id;

--ðŸ”¹ LEVEL 2 â€” JOIN + WHERE vs ON (Interview Trap)
--Q3.
--Tables:
--orders(order_id, customer_id, amount)
--customers(customer_id, city)
--Fetch total order amount per city, but include only orders with amount > 1000.
SELECT c.city, SUM(o.amount) AS total_order_amount FROM orders o JOIN customers c ON o.customer_id = c.customer_id WHERE o.amount > 1000 GROUP BY c.city;

--Q4.
--Tables:
--employees(emp_id, emp_name, dept_id)
--departments(dept_id, dept_name)
--Fetch all departments, even if no employees are assigned.
SELECT e.emp_id, e.emp_name, e.dept_id, d.dept_name FROM employees e LEFT JOIN departments d ON e.dept_id = d.dept_id
UNION ALL 
SELECT e.emp_id, e.emp_name, e.dept_id, d.dept_name FROM employees e RIGHT JOIN departments d ON e.dept_id = d.dept_id;

--ðŸ”¹ LEVEL 3 â€” Multi-table JOINs
--Q5.
--Tables:
--students(student_id, student_name)
--enrollments(student_id, course_id)
--courses(course_id, course_name)
--Fetch student names and course names.
SELECT s.student_name, c.course_name FROM students s
JOIN enrollments e ON s.student_id = e.student_id
JOIN courses c ON e.course_id = c.course_id;

--Q6.
--Tables:
--orders(order_id, customer_id)
--payments(payment_id, order_id, amount)
--Fetch orders that do not have any payments.
SELECT o.order_id, p.payment_id FROM orders o 
RIGHT JOIN payments p ON o.order_id = p.order_id 
WHERE p.payment_id IS NULL;

--ðŸ”¹ LEVEL 4 â€” Self JOINs (Very Important)
--Q7.
--Table:
--employees(emp_id, emp_name, manager_id)
--Fetch employee name and manager name ðŸ‘‰ Include employees without managers.
SELECT e.emp_name AS Employee, m.emp_name AS Manager FROM employees e LEFT JOIN employees m ON e.emp_id = m.manager_id;

--ðŸ”¹ LEVEL 5 â€” Real Interview JOIN Problems
--Q8.
--Tables:
--orders(order_id, customer_id, order_date)
--returns(order_id, return_date)
--Fetch orders that were never returned.
SELECT o.order_id FROM orders o LEFT JOIN returns r ON o.order_id = r.order_id WHERE r.return_date IS NULL;

--Q9.
--Tables:
--employees(emp_id, emp_name, dept_id)
--salaries(emp_id, salary)
--Fetch employee names whose salary is greater than the average salary.
SELECT e.emp_name FROM employees e JOIN salaries s ON e.emp_id = s.emp_id WHERE s.salary > (SELECT AVG(salary) FROM salaries);

--Q10.
--Tables:
--products(product_id, product_name)
--order_items(order_id, product_id, quantity)
--Fetch products that were never ordered.
SELECT p.product_id FROM products p RIGHT JOIN order_items o ON p.product_id = o.product_id WHERE order_id IS NULL; 
